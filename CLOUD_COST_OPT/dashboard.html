<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Cloud Cost Optimizer - Enhanced Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-adapter-date-fns/2.0.0/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: white;
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            font-weight: 300;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 20px 20px 0 0;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }

        .card h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .metric-card {
            text-align: center;
            position: relative;
        }

        .metric-value {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            position: relative;
        }

        .metric-value.highlight {
            animation: pulse-glow 0.8s ease-out;
        }

        @keyframes pulse-glow {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .metric-label {
            color: #666;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .status-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 10px;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }

        .status-healthy { background: radial-gradient(circle, #10b981, #059669); }
        .status-warning { background: radial-gradient(circle, #f59e0b, #d97706); }
        .status-critical { background: radial-gradient(circle, #ef4444, #dc2626); }
        .online { background: radial-gradient(circle, #10b981, #059669); }
        .offline { background: radial-gradient(circle, #ef4444, #dc2626); }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        /* API Status Section */
        .api-status-section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .api-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .api-status-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-radius: 12px;
            background: rgba(102, 126, 234, 0.05);
            border: 1px solid rgba(102, 126, 234, 0.1);
            transition: all 0.3s ease;
        }

        .api-status-item.offline {
            background: rgba(239, 68, 68, 0.05);
            border-color: rgba(239, 68, 68, 0.1);
        }

        .api-status-item.online {
            background: rgba(16, 185, 129, 0.05);
            border-color: rgba(16, 185, 129, 0.1);
        }

        .api-status-details {
            flex: 1;
        }

        .api-status-name {
            font-weight: 700;
            color: #333;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .api-status-endpoint {
            color: #666;
            font-size: 0.9rem;
            font-family: monospace;
        }

        /* Enhanced Cloud Configuration Section */
        .cloud-config-section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .cloud-config-section h3 {
            color: #333;
            margin-bottom: 25px;
            font-size: 1.6rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-group.hidden {
            display: none;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f9fafb;
            font-family: inherit;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            background: white;
            transform: translateY(-2px);
        }

        .form-group input[type="password"] {
            font-family: monospace;
            letter-spacing: 3px;
        }

        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .password-toggle:hover {
            color: #667eea;
        }

        .cloud-provider-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        /* Enhanced Cloud Provider Selection with Proper Icons */
        .cloud-provider {
            padding: 20px;
            border: 3px solid #e5e7eb;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: #f9fafb;
            position: relative;
            overflow: hidden;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .cloud-provider::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .cloud-provider:hover::before {
            opacity: 1;
        }

        .cloud-provider.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
            color: #667eea;
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .cloud-provider.selected::before {
            opacity: 1;
        }

        /* Specific Cloud Provider Colors and Icons */
        .cloud-provider.aws.selected {
            border-color: #ff9900;
            background: linear-gradient(135deg, rgba(255, 153, 0, 0.15), rgba(255, 153, 0, 0.1));
            color: #ff9900;
            box-shadow: 0 10px 30px rgba(255, 153, 0, 0.4);
        }

        .cloud-provider.aws .provider-icon {
            background: linear-gradient(135deg, #ff9900, #cc7700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cloud-provider.gcp.selected {
            border-color: #4285f4;
            background: linear-gradient(135deg, rgba(66, 133, 244, 0.15), rgba(66, 133, 244, 0.1));
            color: #4285f4;
            box-shadow: 0 10px 30px rgba(66, 133, 244, 0.4);
        }

        .cloud-provider.gcp .provider-icon {
            background: linear-gradient(135deg, #4285f4, #1a73e8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cloud-provider.azure.selected {
            border-color: #0078d4;
            background: linear-gradient(135deg, rgba(0, 120, 212, 0.15), rgba(0, 120, 212, 0.1));
            color: #0078d4;
            box-shadow: 0 10px 30px rgba(0, 120, 212, 0.4);
        }

        .cloud-provider.azure .provider-icon {
            background: linear-gradient(135deg, #0078d4, #106ebe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cloud-provider.digitalocean.selected {
            border-color: #0080ff;
            background: linear-gradient(135deg, rgba(0, 128, 255, 0.15), rgba(0, 128, 255, 0.1));
            color: #0080ff;
            box-shadow: 0 10px 30px rgba(0, 128, 255, 0.4);
        }

        .cloud-provider.digitalocean .provider-icon {
            background: linear-gradient(135deg, #0080ff, #0066cc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cloud-provider.linode.selected {
            border-color: #00b04f;
            background: linear-gradient(135deg, rgba(0, 176, 79, 0.15), rgba(0, 176, 79, 0.1));
            color: #00b04f;
            box-shadow: 0 10px 30px rgba(0, 176, 79, 0.4);
        }

        .cloud-provider.linode .provider-icon {
            background: linear-gradient(135deg, #00b04f, #009639);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cloud-provider.vultr.selected {
            border-color: #007bfc;
            background: linear-gradient(135deg, rgba(0, 123, 252, 0.15), rgba(0, 123, 252, 0.1));
            color: #007bfc;
            box-shadow: 0 10px 30px rgba(0, 123, 252, 0.4);
        }

        .cloud-provider.vultr .provider-icon {
            background: linear-gradient(135deg, #007bfc, #0056b3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cloud-provider.other.selected {
            border-color: #6b7280;
            background: linear-gradient(135deg, rgba(107, 114, 128, 0.15), rgba(107, 114, 128, 0.1));
            color: #6b7280;
            box-shadow: 0 10px 30px rgba(107, 114, 128, 0.4);
        }

        .cloud-provider.other .provider-icon {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .provider-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
            position: relative;
            z-index: 1;
            line-height: 1;
        }

        .provider-name {
            font-weight: 700;
            font-size: 0.95rem;
            position: relative;
            z-index: 1;
            margin-top: 5px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: fit-content;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn.connecting {
            pointer-events: none;
            opacity: 0.8;
        }

        .btn:disabled {
            background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Enhanced Charts */
        .chart-container {
            position: relative;
            height: 350px;
            margin-top: 20px;
            padding: 10px;
            border-radius: 12px;
            background: rgba(102, 126, 234, 0.02);
        }

        .chart-container.realtime {
            border: 2px solid rgba(102, 126, 234, 0.3);
            animation: chart-glow 2s infinite alternate;
        }

        @keyframes chart-glow {
            0% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.2); }
            100% { box-shadow: 0 0 30px rgba(102, 126, 234, 0.4); }
        }

        /* Enhanced Prediction Results */
        .prediction-results {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 15px 50px rgba(102, 126, 234, 0.4);
            animation: slideInScale 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .prediction-results::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        @keyframes slideInScale {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(30px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .prediction-title {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            z-index: 1;
        }

        .prediction-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
            position: relative;
            z-index: 1;
        }

        .prediction-item {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .prediction-item:hover {
            transform: translateY(-5px) scale(1.02);
            background: rgba(255, 255, 255, 0.25);
        }

        .prediction-value {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .prediction-label {
            font-size: 0.9rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            font-weight: 600;
        }

        /* Real-time Auto-scaling Simulation */
        .autoscaling-simulation {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 25px;
            margin-top: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 1;
        }

        .simulation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .scaling-title {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .simulation-status {
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            font-weight: 600;
            font-size: 0.9rem;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .scaling-progress {
            height: 35px;
            position: relative;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #34d399, #6ee7b7);
            width: 0%;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 0.95rem;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: progress-shine 2s infinite;
        }

        @keyframes progress-shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Real-time Autoscaling Chart */
        .realtime-autoscaling-chart {
            background: rgba(0, 0, 0, 0.15);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 1;
        }

        .realtime-chart-title {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .realtime-chart-container {
            height: 250px;
            position: relative;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .simulation-log {
            max-height: 180px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.15);
            border-radius: 15px;
            padding: 15px;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .log-entry {
            margin-bottom: 8px;
            opacity: 0;
            animation: fadeInSlide 0.6s ease forwards;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 5px 0;
        }

        .log-entry i {
            font-size: 0.9rem;
            flex-shrink: 0;
            margin-top: 3px;
        }

        .log-entry.success { color: #10b981; }
        .log-entry.warning { color: #f59e0b; }
        .log-entry.info { color: #3b82f6; }
        .log-entry.error { color: #ef4444; }

        @keyframes fadeInSlide {
            0% {
                opacity: 0;
                transform: translateX(-20px) translateY(10px);
            }
            100% {
                opacity: 1;
                transform: translateX(0) translateY(0);
            }
        }

        /* Server Fleet Visualization */
        .server-list {
            max-height: 350px;
            overflow-y: auto;
            padding-right: 15px;
        }

        .server-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            border-radius: 15px;
            margin-bottom: 12px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(102, 126, 234, 0.1);
            opacity: 0;
            animation: fadeInUp 0.5s ease forwards;
        }

        .server-item:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
            transform: translateX(8px) translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .server-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .server-icon {
            font-size: 1.8rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .server-details {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .server-name {
            font-weight: 700;
            color: #333;
            font-size: 1.05rem;
        }

        .server-type {
            color: #666;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .server-cost {
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.1rem;
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Alert System */
        .alert {
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 5px solid;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.5s ease;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .alert-success {
            background: linear-gradient(135deg, #ecfdf5, #d1fae5);
            color: #065f46;
            border-left-color: #10b981;
        }

        .alert-warning {
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
            color: #92400e;
            border-left-color: #f59e0b;
        }

        .alert-error {
            background: linear-gradient(135deg, #fef2f2, #fecaca);
            color: #991b1b;
            border-left-color: #ef4444;
        }

        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateX(-100%);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .prediction-details {
                grid-template-columns: 1fr;
            }

            .config-grid {
                grid-template-columns: 1fr;
            }

            .cloud-provider-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #5a6fd8, #6b46a3);
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-cloud"></i> AI Cloud Cost Optimizer</h1>
            <p>Intelligent traffic prediction and real-time auto-scaling for any cloud platform</p>
        </div>

        <!-- API Status Section -->
        <div class="api-status-section">
            <h3><i class="fas fa-server"></i> API Status Monitor</h3>
            <div class="api-status-grid">
                <div class="api-status-item" id="apiStatusMain">
                    <span class="status-indicator status-warning" id="apiStatusIndicator"></span>
                    <div class="api-status-details">
                        <div class="api-status-name">Main API Server</div>
                        <div class="api-status-endpoint">Dashboard & Prediction API</div>
                    </div>
                </div>
                <div class="api-status-item" id="apiStatusPrediction">
                    <span class="status-indicator status-warning" id="predictionStatusIndicator"></span>
                    <div class="api-status-details">
                        <div class="api-status-name">Prediction Service</div>
                        <div class="api-status-endpoint">/predict endpoint</div>
                    </div>
                </div>
                <div class="api-status-item" id="apiStatusCloud">
                    <span class="status-indicator status-warning" id="cloudStatusIndicator"></span>
                    <div class="api-status-details">
                        <div class="api-status-name">Cloud Connection</div>
                        <div class="api-status-endpoint">Provider APIs</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Dashboard Metrics -->
        <div class="dashboard-grid">
            <div class="card metric-card">
                <h3><i class="fas fa-chart-line"></i> Current Traffic</h3>
                <div class="metric-value" id="currentTraffic">--</div>
                <div class="metric-label">Page Views/Hour</div>
            </div>

            <div class="card metric-card">
                <h3><i class="fas fa-server"></i> Active Servers</h3>
                <div class="metric-value" id="activeServers">--</div>
                <div class="metric-label">Running Instances</div>
            </div>

            <div class="card metric-card">
                <h3><i class="fas fa-money-bill-wave"></i> Current Cost</h3>
                <div class="metric-value" id="currentCost">--</div>
                <div class="metric-label">$/Hour</div>
            </div>

            <div class="card metric-card">
                <h3><i class="fas fa-globe"></i> Cloud Status</h3>
                <div class="metric-value">
                    <span class="status-indicator" id="cloudStatus"></span>
                    <span id="cloudStatusText">--</span>
                </div>
                <div class="metric-label" id="cloudProvider">Not Connected</div>
            </div>
        </div>

        <!-- Enhanced Cloud Configuration Section -->
        <div class="cloud-config-section">
            <h3><i class="fas fa-cloud-upload-alt"></i> Cloud Platform Configuration</h3>

            <div class="form-group">
                <label>Select Cloud Provider</label>
                <div class="cloud-provider-grid">
                    <div class="cloud-provider aws" data-provider="aws">
                        <i class="fab fa-aws provider-icon"></i>
                        <div class="provider-name">AWS</div>
                    </div>
                    <div class="cloud-provider gcp" data-provider="gcp">
                        <i class="fab fa-google provider-icon"></i>
                        <div class="provider-name">Google Cloud</div>
                    </div>
                    <div class="cloud-provider azure" data-provider="azure">
                        <i class="fab fa-microsoft provider-icon"></i>
                        <div class="provider-name">Azure</div>
                    </div>
                    <div class="cloud-provider digitalocean" data-provider="digitalocean">
                        <i class="fab fa-digital-ocean provider-icon"></i>
                        <div class="provider-name">DigitalOcean</div>
                    </div>
                    <div class="cloud-provider linode" data-provider="linode">
                        <i class="fas fa-server provider-icon"></i>
                        <div class="provider-name">Linode</div>
                    </div>
                    <div class="cloud-provider vultr" data-provider="vultr">
                        <i class="fas fa-cloud provider-icon"></i>
                        <div class="provider-name">Vultr</div>
                    </div>
                    <div class="cloud-provider other" data-provider="other">
                        <i class="fas fa-plus provider-icon"></i>
                        <div class="provider-name">Other</div>
                    </div>
                </div>
            </div>

            <div class="config-grid">
                <div class="form-group hidden" id="customProviderGroup">
                    <label for="customProvider">Custom Provider Name</label>
                    <input type="text" id="customProvider" placeholder="Enter custom cloud provider">
                </div>

                <div class="form-group">
                    <label for="cloudRegion">Region</label>
                    <select id="cloudRegion">
                        <option value="">Select Region</option>
                        <optgroup label="AWS Regions">
                            <option value="us-east-1">US East (N. Virginia)</option>
                            <option value="us-east-2">US East (Ohio)</option>
                            <option value="us-west-1">US West (N. California)</option>
                            <option value="us-west-2">US West (Oregon)</option>
                            <option value="eu-west-1">Europe (Ireland)</option>
                            <option value="eu-west-2">Europe (London)</option>
                            <option value="eu-central-1">Europe (Frankfurt)</option>
                            <option value="ap-southeast-1">Asia Pacific (Singapore)</option>
                            <option value="ap-northeast-1">Asia Pacific (Tokyo)</option>
                            <option value="ap-south-1">Asia Pacific (Mumbai)</option>
                        </optgroup>
                        <optgroup label="Google Cloud Regions">
                            <option value="us-central1">US Central</option>
                            <option value="us-east1">US East</option>
                            <option value="us-west1">US West</option>
                            <option value="europe-west1">Europe West</option>
                            <option value="asia-east1">Asia East</option>
                            <option value="asia-southeast1">Asia Southeast</option>
                        </optgroup>
                        <optgroup label="Azure Regions">
                            <option value="eastus">East US</option>
                            <option value="westus">West US</option>
                            <option value="westeurope">West Europe</option>
                            <option value="eastasia">East Asia</option>
                            <option value="southeastasia">Southeast Asia</option>
                        </optgroup>
                        <optgroup label="Other Regions">
                            <option value="nyc1">NYC1</option>
                            <option value="sgp1">Singapore</option>
                            <option value="lon1">London</option>
                            <option value="fra1">Frankfurt</option>
                            <option value="tor1">Toronto</option>
                        </optgroup>
                    </select>
                </div>

                <div class="form-group">
                    <label for="accessKeyId">Access Key ID / Client ID</label>
                    <input type="text" id="accessKeyId" placeholder="Enter your access key ID">
                </div>

                <div class="form-group" style="position: relative;">
                    <label for="secretKey">Secret Key / Password</label>
                    <input type="password" id="secretKey" placeholder="Enter your secret key">
                    <i class="fas fa-eye password-toggle" onclick="togglePassword('secretKey')"></i>
                </div>

                <div class="form-group">
                    <label for="apiEndpoint">API Endpoint (Optional)</label>
                    <input type="url" id="apiEndpoint" placeholder="https://api.yourcloud.com">
                </div>

                <div class="form-group">
                    <label for="websiteUrl">Website URL</label>
                    <input type="url" id="websiteUrl" placeholder="https://yourwebsite.com" required>
                </div>
            </div>

            <button type="button" class="btn" id="connectCloudBtn">
                <i class="fas fa-plug"></i>
                <span id="connectBtnText">Connect to Cloud</span>
                <span id="connectLoader" class="loading" style="display: none;"></span>
            </button>
        </div>

        <!-- Enhanced Traffic Prediction Section -->
        <div class="cloud-config-section">
            <h3><i class="fas fa-crystal-ball"></i> Traffic Prediction & Auto-Scaling</h3>
            <div id="alertContainer"></div>

            <form id="predictionForm">
                <div class="config-grid">
                    <div class="form-group">
                        <label for="sessionDuration">Session Duration (minutes)</label>
                        <input type="number" id="sessionDuration" value="3.5" step="0.1" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="bounceRate">Bounce Rate (%)</label>
                        <input type="number" id="bounceRate" value="45" step="0.1" min="0" max="100" required>
                    </div>
                    <div class="form-group">
                        <label for="previousVisits">Previous Visits</label>
                        <input type="number" id="previousVisits" value="5" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="conversionRate">Conversion Rate (%)</label>
                        <input type="number" id="conversionRate" value="2.5" step="0.1" min="0" max="100" required>
                    </div>
                    <div class="form-group">
                        <label for="trafficSource">Traffic Source</label>
                        <select id="trafficSource" required>
                            <option value="Organic">Organic Search</option>
                            <option value="Paid">Paid Advertising</option>
                            <option value="Referral">Referral Traffic</option>
                            <option value="Social">Social Media</option>
                            <option value="Direct">Direct Traffic</option>
                            <option value="Email">Email Marketing</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="currentServers">Current Active Servers</label>
                        <input type="number" id="currentServers" value="1" min="1" required>
                    </div>
                </div>
                <button type="submit" class="btn" id="predictBtn">
                    <i class="fas fa-magic"></i>
                    <span id="btnText">Predict & Auto-Scale</span>
                    <span id="btnLoader" class="loading" style="display: none;"></span>
                </button>
            </form>
        </div>

        <!-- Enhanced Real-time Charts Grid -->
        <div class="dashboard-grid">
            <div class="card">
                <h3><i class="fas fa-chart-area"></i> Real-time Traffic Forecast</h3>
                <div class="chart-container realtime">
                    <canvas id="trafficChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-coins"></i> Live Cost Analysis</h3>
                <div class="chart-container realtime">
                    <canvas id="costChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-server"></i> Auto-Scaling Timeline</h3>
                <div class="chart-container realtime">
                    <canvas id="serverCountChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-tachometer-alt"></i> Performance Metrics</h3>
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Enhanced Server Fleet Status -->
        <div class="card">
            <h3><i class="fas fa-network-wired"></i> Live Server Fleet Management</h3>
            <div class="server-list" id="serverList">
                <p style="text-align: center; color: #666; font-style: italic;">Connect to cloud and make a prediction to see server status.</p>
            </div>
        </div>
    </div>

    <!-- Floating Action Button for Quick Actions -->
    <button class="fab" onclick="refreshDashboard()">
        <i class="fas fa-sync-alt"></i>
    </button>

    <script>
        class EnhancedCloudDashboard {
            constructor() {
                this.apiUrl = window.location.origin; // Updated to use current domain
                this.charts = {};
                this.realtimeAutoscalingChart = null;
                this.updateInterval = 15000;
                this.isCloudConnected = false;
                this.isApiOnline = false;
                this.selectedProvider = null;
                this.realTimeData = {
                    traffic: [],
                    cost: [],
                    servers: [],
                    performance: []
                };

                this.historicalLabels = this.generateTimeLabels();
                this.historicalTraffic = this.generateRealisticTrafficData();
                this.historicalCosts = this.calculateCostsFromTraffic(this.historicalTraffic);
                this.historicalServers = this.calculateServersFromTraffic(this.historicalTraffic);
                this.performanceMetrics = this.generatePerformanceData();

                this.init();
            }

            init() {
                this.setupEventListeners();
                this.initEnhancedCharts();
                this.updateDashboardMetrics();
                this.checkApiHealth();
                this.startRealTimeUpdates();
            }

            generateTimeLabels() {
                const labels = [];
                const now = new Date();
                for (let i = 11; i >= 0; i--) {
                    const time = new Date(now.getTime() - i * 3600000);
                    labels.push(time.toLocaleTimeString('en-US', {
                        hour: '2-digit',
                        minute: '2-digit'
                    }));
                }
                return labels;
            }

            generateRealisticTrafficData() {
                const data = [];
                const now = new Date();
                const baseTraffic = 1000;

                for (let i = 11; i >= 0; i--) {
                    const time = new Date(now.getTime() - i * 3600000);
                    const hour = time.getHours();

                    let multiplier = 1;
                    if (hour >= 9 && hour <= 17) multiplier = 1.5;
                    if (hour >= 18 && hour <= 22) multiplier = 1.8;
                    if (hour >= 0 && hour <= 6) multiplier = 0.3;

                    const isWeekend = time.getDay() === 0 || time.getDay() === 6;
                    if (isWeekend) multiplier *= 0.7;

                    const noise = (Math.random() - 0.5) * 0.4 + 1;
                    const traffic = Math.max(50, baseTraffic * multiplier * noise);
                    data.push(Math.round(traffic));
                }
                return data;
            }

            calculateCostsFromTraffic(trafficData) {
                return trafficData.map(traffic => {
                    const servers = Math.max(1, Math.ceil(traffic / 400));
                    return servers * 0.0208;
                });
            }

            calculateServersFromTraffic(trafficData) {
                return trafficData.map(traffic => Math.max(1, Math.ceil(traffic / 400)));
            }

            generatePerformanceData() {
                return {
                    responseTime: this.historicalTraffic.map(traffic => {
                        const utilization = traffic / 400;
                        return Math.max(0.5, Math.min(5, 0.5 + utilization * 2));
                    }),
                    cpuUsage: this.historicalTraffic.map(traffic => {
                        return Math.max(10, Math.min(90, (traffic / 400) * 70));
                    }),
                    memoryUsage: this.historicalTraffic.map(traffic => {
                        return Math.max(15, Math.min(85, (traffic / 400) * 60 + Math.random() * 10));
                    })
                };
            }

            setupEventListeners() {
                // Cloud provider selection with enhanced visual feedback
                document.querySelectorAll('.cloud-provider').forEach(provider => {
                    provider.addEventListener('click', (e) => {
                        // Remove selected class from all providers
                        document.querySelectorAll('.cloud-provider').forEach(p => p.classList.remove('selected'));

                        // Add selected class to clicked provider
                        provider.classList.add('selected');
                        this.selectedProvider = provider.dataset.provider;

                        // Handle custom provider input
                        const customProviderGroup = document.getElementById('customProviderGroup');
                        const customInput = document.getElementById('customProvider');

                        if (this.selectedProvider === 'other') {
                            customProviderGroup.classList.remove('hidden');
                            customInput.required = true;
                        } else {
                            customProviderGroup.classList.add('hidden');
                            customInput.required = false;
                            customInput.value = '';
                        }
                    });
                });

                // Cloud connection
                document.getElementById('connectCloudBtn').addEventListener('click', () => {
                    this.connectToCloud();
                });

                // Prediction form
                document.getElementById('predictionForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.makePrediction();
                });
            }

            // Enhanced API Status Checking
            async checkApiStatus() {
                try {
                    const response = await fetch(`${this.apiUrl}/api/status`);
                    if (response.ok) {
                        const data = await response.json();
                        document.getElementById('apiStatusIndicator').className = 'status-indicator status-healthy';
                        document.getElementById('predictionStatusIndicator').className = 'status-indicator status-healthy';

                        // Update API status items
                        document.getElementById('apiStatusMain').classList.remove('offline');
                        document.getElementById('apiStatusMain').classList.add('online');
                        document.getElementById('apiStatusPrediction').classList.remove('offline');
                        document.getElementById('apiStatusPrediction').classList.add('online');

                        this.isApiOnline = true;
                        this.enableApiFeatures();
                        return true;
                    }
                } catch (error) {
                    console.error('API status check failed:', error);
                }

                // If we reach here, API is offline
                document.getElementById('apiStatusIndicator').className = 'status-indicator status-critical';
                document.getElementById('predictionStatusIndicator').className = 'status-indicator status-critical';

                document.getElementById('apiStatusMain').classList.remove('online');
                document.getElementById('apiStatusMain').classList.add('offline');
                document.getElementById('apiStatusPrediction').classList.remove('online');
                document.getElementById('apiStatusPrediction').classList.add('offline');

                this.isApiOnline = false;
                this.disableApiFeatures();
                return false;
            }

            async checkApiHealth() {
                // Call the status check method
                await this.checkApiStatus();

                // Also check the health endpoint
                try {
                    const response = await fetch(`${this.apiUrl}/health`);
                    if (response.ok) {
                        this.isApiOnline = true;
                        this.enableApiFeatures();
                    } else {
                        throw new Error('Health check failed');
                    }
                } catch (error) {
                    this.isApiOnline = false;
                    this.disableApiFeatures();
                }
            }

            updateApiStatus(status) {
                const mainApiEl = document.getElementById('apiStatusMain');
                const predictionApiEl = document.getElementById('apiStatusPrediction');
                const cloudApiEl = document.getElementById('apiStatusCloud');

                const mainIndicator = document.getElementById('apiStatusIndicator');
                const predictionIndicator = document.getElementById('predictionStatusIndicator');
                const cloudIndicator = document.getElementById('cloudStatusIndicator');

                if (status === 'online') {
                    mainApiEl.classList.remove('offline');
                    mainApiEl.classList.add('online');
                    mainIndicator.className = 'status-indicator status-healthy';

                    predictionApiEl.classList.remove('offline');
                    predictionApiEl.classList.add('online');
                    predictionIndicator.className = 'status-indicator status-healthy';

                    if (this.isCloudConnected) {
                        cloudApiEl.classList.remove('offline');
                        cloudApiEl.classList.add('online');
                        cloudIndicator.className = 'status-indicator status-healthy';
                    }
                } else {
                    mainApiEl.classList.remove('online');
                    mainApiEl.classList.add('offline');
                    mainIndicator.className = 'status-indicator status-critical';

                    predictionApiEl.classList.remove('online');
                    predictionApiEl.classList.add('offline');
                    predictionIndicator.className = 'status-indicator status-critical';

                    cloudApiEl.classList.remove('online');
                    cloudApiEl.classList.add('offline');
                    cloudIndicator.className = 'status-indicator status-critical';
                }
            }

            enableApiFeatures() {
                const predictBtn = document.getElementById('predictBtn');
                const connectBtn = document.getElementById('connectCloudBtn');

                predictBtn.disabled = false;
                connectBtn.disabled = false;

                const serverList = document.getElementById('serverList');
                if (serverList.innerHTML.includes('Connect to cloud and make a prediction')) {
                    serverList.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">Connect to cloud and make a prediction to see server status.</p>';
                }
            }

            disableApiFeatures() {
                const predictBtn = document.getElementById('predictBtn');
                const connectBtn = document.getElementById('connectCloudBtn');

                predictBtn.disabled = true;
                connectBtn.disabled = true;

                const serverList = document.getElementById('serverList');
                serverList.innerHTML = '<p style="text-align: center; color: #ef4444; font-style: italic;">API is offline. Please ensure your API server is running to use prediction and cloud features.</p>';

                this.showAlert('error', '<i class="fas fa-exclamation-triangle"></i> API is offline. Please start your API server to use prediction and cloud features.');
            }

            async connectToCloud() {
                if (!this.isApiOnline) {
                    this.showAlert('error', '<i class="fas fa-exclamation-triangle"></i> API is offline. Please start your API server first.');
                    return;
                }

                const btn = document.getElementById('connectCloudBtn');
                const btnText = document.getElementById('connectBtnText');
                const loader = document.getElementById('connectLoader');

                if (!this.selectedProvider) {
                    this.showAlert('error', '<i class="fas fa-exclamation-circle"></i> Please select a cloud provider first.');
                    return;
                }

                btnText.style.display = 'none';
                loader.style.display = 'inline-block';
                btn.classList.add('connecting');

                try {
                    await this.simulateCloudConnection();
                    this.isCloudConnected = true;
                    this.updateCloudStatus('connected');
                    this.updateApiStatus('online');

                    // Update cloud status indicator
                    document.getElementById('cloudStatusIndicator').className = 'status-indicator status-healthy';
                    document.getElementById('apiStatusCloud').classList.remove('offline');
                    document.getElementById('apiStatusCloud').classList.add('online');

                    this.showAlert('success', '<i class="fas fa-check-circle"></i> Successfully connected to cloud platform!');
                    btnText.textContent = 'Reconnect to Cloud';
                } catch (error) {
                    this.showAlert('error', `<i class="fas fa-exclamation-triangle"></i> Connection failed: ${error.message}`);
                    this.updateCloudStatus('error');
                } finally {
                    btnText.style.display = 'inline';
                    loader.style.display = 'none';
                    btn.classList.remove('connecting');
                }
            }

            async simulateCloudConnection() {
                await this.delay(1000);
                this.showConnectionLog('Validating credentials...');
                await this.delay(1500);
                this.showConnectionLog('Establishing secure connection...');
                await this.delay(1200);
                this.showConnectionLog('Fetching server configurations...');
                await this.delay(800);
                this.showConnectionLog('Connection established successfully!');
            }

            showConnectionLog(message) {
                console.log(`Cloud Connection: ${message}`);
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            updateCloudStatus(status) {
                const statusEl = document.getElementById('cloudStatus');
                const statusTextEl = document.getElementById('cloudStatusText');
                const providerEl = document.getElementById('cloudProvider');

                switch (status) {
                    case 'connected':
                        statusEl.className = 'status-indicator status-healthy';
                        statusTextEl.textContent = 'Connected';
                        providerEl.textContent = this.getProviderDisplayName();
                        break;
                    case 'error':
                        statusEl.className = 'status-indicator status-critical';
                        statusTextEl.textContent = 'Failed';
                        providerEl.textContent = 'Connection Error';
                        break;
                    default:
                        statusEl.className = 'status-indicator status-warning';
                        statusTextEl.textContent = 'Disconnected';
                        providerEl.textContent = 'Not Connected';
                }
            }

            getProviderDisplayName() {
                const providers = {
                    'aws': 'Amazon Web Services',
                    'gcp': 'Google Cloud Platform',
                    'azure': 'Microsoft Azure',
                    'digitalocean': 'DigitalOcean',
                    'linode': 'Linode',
                    'vultr': 'Vultr',
                    'other': document.getElementById('customProvider').value || 'Custom Provider'
                };
                return providers[this.selectedProvider] || 'Unknown';
            }

            initEnhancedCharts() {
                // Traffic Chart with better legend differentiation
                const trafficCtx = document.getElementById('trafficChart').getContext('2d');
                this.charts.traffic = new Chart(trafficCtx, {
                    type: 'line',
                    data: {
                        labels: this.historicalLabels.slice(),
                        datasets: [
                            {
                                label: ' Actual Traffic Data',
                                data: this.historicalTraffic.slice(),
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                fill: true,
                                tension: 0.4,
                                pointRadius: 6,
                                pointHoverRadius: 8,
                                borderWidth: 3,
                                pointBackgroundColor: '#3b82f6',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 2
                            },
                            {
                                label: ' AI Predicted Traffic',
                                data: new Array(this.historicalLabels.length).fill(null),
                                borderColor: '#f59e0b',
                                backgroundColor: 'transparent',
                                borderDash: [12, 6],
                                fill: false,
                                tension: 0.4,
                                pointRadius: 6,
                                borderWidth: 4,
                                pointBackgroundColor: '#f59e0b',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 2
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 1000,
                            easing: 'easeInOutCubic'
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                align: 'center',
                                labels: {
                                    color: '#333',
                                    font: { weight: 'bold', size: 13 },
                                    padding: 20,
                                    usePointStyle: true,
                                    pointStyle: 'line',
                                    boxHeight: 3
                                }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                backgroundColor: 'rgba(0, 0, 0, 0.85)',
                                titleColor: 'white',
                                bodyColor: 'white',
                                borderColor: '#3b82f6',
                                borderWidth: 2,
                                cornerRadius: 8
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(59, 130, 246, 0.1)' },
                                title: { display: true, text: 'Page Views per Hour', font: { weight: 'bold' } }
                            },
                            x: {
                                grid: { color: 'rgba(59, 130, 246, 0.1)' },
                                title: { display: true, text: 'Time', font: { weight: 'bold' } }
                            }
                        }
                    }
                });

                // Cost Chart with better differentiation
                const costCtx = document.getElementById('costChart').getContext('2d');
                this.charts.cost = new Chart(costCtx, {
                    type: 'bar',
                    data: {
                        labels: this.historicalLabels.slice(),
                        datasets: [
                            {
                                label: ' Current Hourly Cost',
                                data: this.historicalCosts.slice(),
                                backgroundColor: 'rgba(16, 185, 129, 0.8)',
                                borderColor: '#10b981',
                                borderWidth: 2,
                                borderRadius: 6
                            },
                            {
                                label: ' Projected Cost',
                                data: new Array(this.historicalLabels.length).fill(null),
                                backgroundColor: 'rgba(245, 158, 11, 0.8)',
                                borderColor: '#f59e0b',
                                borderWidth: 2,
                                borderRadius: 6
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: { duration: 1000, easing: 'easeInOutCubic' },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                align: 'center',
                                labels: {
                                    color: '#333',
                                    font: { weight: 'bold', size: 13 },
                                    padding: 20,
                                    usePointStyle: true
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.85)',
                                titleColor: 'white',
                                bodyColor: 'white',
                                cornerRadius: 8
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(16, 185, 129, 0.1)' },
                                title: { display: true, text: 'Cost ($/hour)', font: { weight: 'bold' } }
                            },
                            x: {
                                grid: { color: 'rgba(16, 185, 129, 0.1)' },
                                title: { display: true, text: 'Time', font: { weight: 'bold' } }
                            }
                        }
                    }
                });

                // Server Count Chart with better visualization
                const serverCtx = document.getElementById('serverCountChart').getContext('2d');
                this.charts.serverCount = new Chart(serverCtx, {
                    type: 'line',
                    data: {
                        labels: this.historicalLabels.slice(),
                        datasets: [
                            {
                                label: ' Current Server Count',
                                data: this.historicalServers.slice(),
                                borderColor: '#8b5cf6',
                                backgroundColor: 'rgba(139, 92, 246, 0.2)',
                                fill: true,
                                tension: 0.3,
                                pointStyle: 'rect',
                                pointRadius: 7,
                                borderWidth: 3,
                                pointBackgroundColor: '#8b5cf6',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 2
                            },
                            {
                                label: ' AI Recommended',
                                data: new Array(this.historicalLabels.length).fill(null),
                                borderColor: '#ef4444',
                                backgroundColor: 'transparent',
                                borderDash: [10, 5],
                                fill: false,
                                tension: 0.3,
                                pointRadius: 7,
                                borderWidth: 3,
                                pointBackgroundColor: '#ef4444',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 2,
                                pointStyle: 'triangle'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: { duration: 1000, easing: 'easeInOutCubic' },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                align: 'center',
                                labels: {
                                    color: '#333',
                                    font: { weight: 'bold', size: 13 },
                                    padding: 20,
                                    usePointStyle: true
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.85)',
                                cornerRadius: 8,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${Math.round(context.parsed.y)} servers`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                precision: 0,
                                grid: { color: 'rgba(139, 92, 246, 0.1)' },
                                title: { display: true, text: 'Number of Servers', font: { weight: 'bold' } }
                            },
                            x: {
                                grid: { color: 'rgba(139, 92, 246, 0.1)' },
                                title: { display: true, text: 'Time', font: { weight: 'bold' } }
                            }
                        }
                    }
                });

                // Performance Chart
                const perfCtx = document.getElementById('performanceChart').getContext('2d');
                this.charts.performance = new Chart(perfCtx, {
                    type: 'radar',
                    data: {
                        labels: ['Response Time', 'CPU Usage', 'Memory Usage', 'Network I/O', 'Disk I/O', 'Throughput'],
                        datasets: [
                            {
                                label: ' Current Performance Metrics',
                                data: [75, 60, 45, 80, 70, 85],
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                pointBackgroundColor: '#10b981',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: '#10b981',
                                borderWidth: 3,
                                pointRadius: 6
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    color: '#333',
                                    font: { weight: 'bold', size: 13 },
                                    padding: 20
                                }
                            }
                        },
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                grid: { color: 'rgba(16, 185, 129, 0.2)' },
                                pointLabels: { color: '#333', font: { weight: 'bold' } }
                            }
                        }
                    }
                });
            }

            // Initialize Real-time Autoscaling Chart with DUAL Y-AXES
            initRealtimeAutoscalingChart(canvasId) {
                const ctx = document.getElementById(canvasId).getContext('2d');

                const labels = [];
                const now = new Date();
                for (let i = 15; i >= 0; i--) {
                    const time = new Date(now.getTime() - i * 60000);
                    labels.push(time.toLocaleTimeString('en-US', {
                        hour: '2-digit',
                        minute: '2-digit'
                    }));
                }

                this.realtimeAutoscalingChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: ' Incoming Traffic',
                                data: new Array(16).fill(0),
                                borderColor: '#ef4444',
                                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                fill: true,
                                tension: 0.4,
                                pointRadius: 4,
                                borderWidth: 3,
                                pointBackgroundColor: '#ef4444',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 1,
                                yAxisID: 'y' // LEFT Y-AXIS
                            },
                            {
                                label: ' ML Prediction',
                                data: new Array(16).fill(0),
                                borderColor: '#8b5cf6',
                                backgroundColor: 'transparent',
                                borderDash: [8, 4],
                                fill: false,
                                tension: 0.4,
                                pointRadius: 5,
                                borderWidth: 3,
                                pointBackgroundColor: '#8b5cf6',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 1,
                                yAxisID: 'y' // LEFT Y-AXIS
                            },
                            {
                                label: ' Auto-scaled Servers',
                                data: new Array(16).fill(0),
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                fill: false,
                                tension: 0.2,
                                pointRadius: 6,
                                borderWidth: 3,
                                pointBackgroundColor: '#10b981',
                                pointBorderColor: '#ffffff',
                                pointBorderWidth: 2,
                                pointStyle: 'rectRot',
                                yAxisID: 'y1' // RIGHT Y-AXIS
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 800,
                            easing: 'easeInOutCubic'
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    color: 'rgba(255, 255, 255, 0.9)',
                                    font: { weight: 'bold', size: 11 },
                                    padding: 15,
                                    usePointStyle: true
                                }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                titleColor: 'white',
                                bodyColor: 'white',
                                borderColor: '#8b5cf6',
                                borderWidth: 1,
                                cornerRadius: 6,
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }

                                        // Add appropriate units
                                        if (context.dataset.yAxisID === 'y1') {
                                            label += Math.round(context.parsed.y) + ' servers';
                                        } else {
                                            label += Math.round(context.parsed.y) + ' views/hour';
                                        }
                                        return label;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { color: 'rgba(255, 255, 255, 0.8)' },
                                title: {
                                    display: true,
                                    text: 'Real-time Timeline',
                                    color: 'rgba(255, 255, 255, 0.8)',
                                    font: { weight: 'bold' }
                                }
                            },
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: {
                                    color: '#ef4444',
                                    font: { weight: 'bold' }
                                },
                                title: {
                                    display: true,
                                    text: 'Traffic (Views/Hour)',
                                    color: '#ef4444',
                                    font: { weight: 'bold' }
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                beginAtZero: true,
                                max: 10, // Set reasonable max for server count
                                grid: {
                                    drawOnChartArea: false, // Don't draw grid lines for right axis
                                },
                                ticks: {
                                    color: '#10b981',
                                    font: { weight: 'bold' },
                                    stepSize: 1 // Show integers only for servers
                                },
                                title: {
                                    display: true,
                                    text: 'Server Count',
                                    color: '#10b981',
                                    font: { weight: 'bold' }
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });
            }

            // Update real-time autoscaling chart with new data
            updateRealtimeAutoscalingChart(trafficData, predictionData, serverData) {
                if (!this.realtimeAutoscalingChart) return;

                const currentTime = new Date().toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit'
                });

                // Add new data point
                this.realtimeAutoscalingChart.data.labels.push(currentTime);
                this.realtimeAutoscalingChart.data.datasets[0].data.push(trafficData);
                this.realtimeAutoscalingChart.data.datasets[1].data.push(predictionData);
                this.realtimeAutoscalingChart.data.datasets[2].data.push(serverData);

                // Remove old data points (keep last 16)
                if (this.realtimeAutoscalingChart.data.labels.length > 16) {
                    this.realtimeAutoscalingChart.data.labels.shift();
                    this.realtimeAutoscalingChart.data.datasets.forEach(dataset => dataset.data.shift());
                }

                // Update chart
                this.realtimeAutoscalingChart.update('none');
            }

            async makePrediction() {
                if (!this.isApiOnline) {
                    this.showAlert('error', '<i class="fas fa-exclamation-triangle"></i> API is offline. Please start your API server first.');
                    return;
                }

                if (!this.isCloudConnected) {
                    this.showAlert('warning', '<i class="fas fa-exclamation-triangle"></i> Please connect to your cloud platform first.');
                    return;
                }

                const btnText = document.getElementById('btnText');
                const btnLoader = document.getElementById('btnLoader');
                const alertContainer = document.getElementById('alertContainer');

                btnText.style.display = 'none';
                btnLoader.style.display = 'inline-block';
                alertContainer.innerHTML = '';

                try {
                    const formData = {
                        session_duration: parseFloat(document.getElementById('sessionDuration').value),
                        bounce_rate: parseFloat(document.getElementById('bounceRate').value) / 100,
                        previous_visits: parseInt(document.getElementById('previousVisits').value),
                        conversion_rate: parseFloat(document.getElementById('conversionRate').value) / 100,
                        traffic_source: document.getElementById('trafficSource').value,
                        current_servers: parseInt(document.getElementById('currentServers').value)
                    };

                    const response = await fetch(`${this.apiUrl}/predict`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(formData)
                    });

                    const result = await response.json();

                    if (response.ok) {
                        this.showEnhancedPredictionResults(result, formData);
                        this.updateChartsWithPrediction(result);
                        this.simulateRealTimeAutoScaling(result);
                        this.updateServerFleet(result.recommended_servers, result.server_type || 't3.micro');
                        this.updateDashboardMetrics(result.predicted_traffic, result.recommended_servers, result.cost_estimate.hourly);
                    } else {
                        this.showAlert('error', `<i class="fas fa-exclamation-circle"></i> Prediction failed: ${result.detail}`);
                    }
                } catch (error) {
                    this.showAlert('error', `<i class="fas fa-exclamation-triangle"></i> Connection error: ${error.message}`);
                    this.checkApiHealth();
                } finally {
                    btnText.style.display = 'inline';
                    btnLoader.style.display = 'none';
                }
            }

            showEnhancedPredictionResults(result, formData) {
                const alertContainer = document.getElementById('alertContainer');
                const currentCost = this.historicalCosts[this.historicalCosts.length - 1];
                const costSavings = Math.max(0, (currentCost - result.cost_estimate.hourly) * 24 * 30);
                const efficiency = (result.predicted_traffic / result.recommended_servers) * 10;
                const slaCompliance = 99.5 + Math.random() * 0.4;
                const carbonFootprint = result.recommended_servers * 0.5;

                const predictionDiv = document.createElement('div');
                predictionDiv.className = 'prediction-results';
                predictionDiv.innerHTML = `
                    <div class="prediction-title">
                        <i class="fas fa-rocket"></i> AI Prediction Results
                        <span style="font-size: 0.9rem; opacity: 0.9; margin-left: auto;">
                            ${new Date().toLocaleString()} | Provider: ${this.getProviderDisplayName()}
                        </span>
                    </div>

                    <div class="prediction-details">
                        <div class="prediction-item">
                            <div class="prediction-value"><i class="fas fa-eye"></i> ${Math.round(result.predicted_traffic)}</div>
                            <div class="prediction-label">Predicted Views/Hour</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-value"><i class="fas fa-server"></i> ${result.recommended_servers}</div>
                            <div class="prediction-label">Recommended Instances</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-value"><i class="fas fa-dollar-sign"></i> ${result.cost_estimate.hourly.toFixed(2)}</div>
                            <div class="prediction-label">Cost per Hour</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-value"><i class="fas fa-piggy-bank"></i> \$${costSavings.toFixed(0)}</div>
                            <div class="prediction-label">Monthly Savings</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-value"><i class="fas fa-tachometer-alt"></i> ${efficiency.toFixed(1)}%</div>
                            <div class="prediction-label">Resource Efficiency</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-value"><i class="fas fa-shield-alt"></i> ${slaCompliance.toFixed(2)}%</div>
                            <div class="prediction-label">SLA Compliance</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-value"><i class="fas fa-leaf"></i> ${carbonFootprint.toFixed(1)}</div>
                            <div class="prediction-label">kg CO/day</div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-value"><i class="fas fa-globe"></i> ${formData.traffic_source}</div>
                            <div class="prediction-label">Primary Source</div>
                        </div>
                    </div>

                    <div class="autoscaling-simulation">
                        <div class="simulation-header">
                            <div class="scaling-title"><i class="fas fa-cogs"></i> Real-time Auto-Scaling</div>
                            <div class="simulation-status" id="simulationStatus">Initializing</div>
                        </div>
                        <div class="scaling-progress">
                            <div class="progress-bar" id="scalingProgress">Preparing...</div>
                        </div>

                        <div class="realtime-autoscaling-chart">
                            <div class="realtime-chart-title">
                                <i class="fas fa-chart-line"></i> ML Model Real-time Auto-scaling Simulation
                            </div>
                            <div class="realtime-chart-container">
                                <canvas id="realtimeAutoscalingChart"></canvas>
                            </div>
                        </div>

                        <div class="simulation-log" id="simulationLog"></div>
                    </div>
                `;

                alertContainer.appendChild(predictionDiv);

                // Initialize the real-time chart
                setTimeout(() => {
                    this.initRealtimeAutoscalingChart('realtimeAutoscalingChart');
                }, 100);
            }

            simulateRealTimeAutoScaling(result) {
                const progressBar = document.getElementById('scalingProgress');
                const simulationLog = document.getElementById('simulationLog');
                const simulationStatus = document.getElementById('simulationStatus');

                simulationLog.innerHTML = '';
                progressBar.style.width = '0%';

                const initialServers = parseInt(document.getElementById('currentServers').value);
                const targetServers = result.recommended_servers;
                const steps = this.generateScalingSteps(initialServers, targetServers, result);

                // Start real-time chart simulation
                this.startRealtimeChartSimulation(result);

                let currentStep = 0;
                const executeStep = () => {
                    if (currentStep < steps.length) {
                        const step = steps[currentStep];

                        progressBar.style.width = `${step.progress}%`;
                        progressBar.textContent = `${Math.round(step.progress)}%`;

                        simulationStatus.textContent = step.status;
                        simulationStatus.className = `simulation-status ${step.statusType}`;

                        const logEntry = document.createElement('div');
                        logEntry.className = `log-entry ${step.type}`;
                        logEntry.innerHTML = `<i class="${step.icon}"></i> <span>[${new Date().toLocaleTimeString()}] ${step.message}</span>`;
                        simulationLog.appendChild(logEntry);

                        simulationLog.scrollTop = simulationLog.scrollHeight;

                        if (step.updateServerCount) {
                            document.getElementById('currentServers').value = step.updateServerCount;
                            this.updateDashboardMetrics(result.predicted_traffic, step.updateServerCount, result.cost_estimate.hourly);
                        }

                        currentStep++;
                        setTimeout(executeStep, 800 + Math.random() * 400);
                    } else {
                        simulationStatus.textContent = 'Completed';
                        simulationStatus.className = 'simulation-status success';
                    }
                };

                setTimeout(executeStep, 500);
            }

            // Start real-time chart simulation
            startRealtimeChartSimulation(result) {
                let simulationStep = 0;
                const totalSteps = 20;
                const baseTraffic = result.predicted_traffic;

                const updateChart = () => {
                    if (simulationStep < totalSteps && this.realtimeAutoscalingChart) {
                        // Generate dynamic traffic with some variation
                        const trafficVariation = (Math.sin(simulationStep * 0.3) + Math.random() - 0.5) * 0.3;
                        const currentTraffic = Math.max(50, baseTraffic * (1 + trafficVariation));

                        // ML model prediction (slightly ahead of current traffic)
                        const predictionVariation = (Math.sin((simulationStep + 2) * 0.3) + Math.random() - 0.5) * 0.2;
                        const predictedTraffic = Math.max(50, baseTraffic * (1 + predictionVariation));

                        // Auto-scaled servers based on prediction
                        const recommendedServers = Math.max(1, Math.ceil(predictedTraffic / 400));

                        // Update the real-time chart
                        this.updateRealtimeAutoscalingChart(
                            Math.round(currentTraffic),
                            Math.round(predictedTraffic),
                            recommendedServers
                        );

                        simulationStep++;
                        setTimeout(updateChart, 1000); // Update every second
                    }
                };

                // Start the simulation after a short delay
                setTimeout(updateChart, 1000);
            }

            generateScalingSteps(current, target, result) {
                const steps = [];
                const diff = target - current;

                steps.push({
                    progress: 10,
                    message: `Analyzing current infrastructure (${current} servers active)`,
                    type: 'info',
                    icon: 'fas fa-search',
                    status: 'Analyzing',
                    statusType: 'warning'
                });

                steps.push({
                    progress: 25,
                    message: `ML model analyzing traffic patterns: ${Math.round(result.predicted_traffic)} views/hour`,
                    type: 'info',
                    icon: 'fas fa-brain',
                    status: 'ML Processing',
                    statusType: 'warning'
                });

                steps.push({
                    progress: 40,
                    message: `Optimal configuration calculated: ${target} instances`,
                    type: 'info',
                    icon: 'fas fa-calculator',
                    status: 'Calculating',
                    statusType: 'warning'
                });

                if (diff !== 0) {
                    const numSteps = Math.abs(diff);
                    for (let i = 1; i <= numSteps; i++) {
                        const stepServers = current + (diff > 0 ? i : -i);
                        const progress = 40 + (i / numSteps) * 40;

                        steps.push({
                            progress: progress,
                            message: diff > 0
                                ? `ML triggered: Provisioning server ${stepServers}`
                                : `ML triggered: Terminating server ${current - i + 1}`,
                            type: diff > 0 ? 'success' : 'warning',
                            icon: diff > 0 ? 'fas fa-plus-circle' : 'fas fa-minus-circle',
                            status: diff > 0 ? 'Scaling Up' : 'Scaling Down',
                            statusType: 'warning',
                            updateServerCount: stepServers
                        });
                    }
                } else {
                    steps.push({
                        progress: 60,
                        message: 'ML model confirms current configuration is optimal',
                        type: 'success',
                        icon: 'fas fa-check-circle',
                        status: 'Optimal',
                        statusType: 'success'
                    });
                }

                steps.push({
                    progress: 85,
                    message: 'ML model monitoring health and optimizing load distribution',
                    type: 'info',
                    icon: 'fas fa-heartbeat',
                    status: 'Optimizing',
                    statusType: 'warning'
                });

                steps.push({
                    progress: 100,
                    message: `ML Auto-scaling complete! ${target} servers active, cost: \$${result.cost_estimate.hourly.toFixed(2)}/hour`,
                    type: 'success',
                    icon: 'fas fa-check-double',
                    status: 'Active',
                    statusType: 'success'
                });

                return steps;
            }

            updateChartsWithPrediction(result) {
                const currentTime = new Date().toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit'
                });

                this.charts.traffic.data.labels.push(currentTime);
                this.charts.traffic.data.datasets[0].data.push(result.predicted_traffic);
                this.charts.traffic.data.datasets[1].data.push(result.predicted_traffic);

                this.charts.cost.data.labels.push(currentTime);
                this.charts.cost.data.datasets[0].data.push(result.cost_estimate.hourly);
                this.charts.cost.data.datasets[1].data.push(result.cost_estimate.hourly);

                this.charts.serverCount.data.labels.push(currentTime);
                this.charts.serverCount.data.datasets[0].data.push(result.recommended_servers);
                this.charts.serverCount.data.datasets[1].data.push(result.recommended_servers);

                if (this.charts.traffic.data.labels.length > 12) {
                    this.charts.traffic.data.labels.shift();
                    this.charts.traffic.data.datasets.forEach(dataset => dataset.data.shift());

                    this.charts.cost.data.labels.shift();
                    this.charts.cost.data.datasets.forEach(dataset => dataset.data.shift());

                    this.charts.serverCount.data.labels.shift();
                    this.charts.serverCount.data.datasets.forEach(dataset => dataset.data.shift());
                }

                Object.values(this.charts).forEach(chart => {
                    if (chart.update) chart.update('active');
                });
            }

            updateServerFleet(recommendedServers, serverType) {
                const serverListEl = document.getElementById('serverList');
                serverListEl.innerHTML = '';

                if (recommendedServers === 0) {
                    serverListEl.innerHTML = '<p style="text-align: center; color: #666; font-style: italic;">No servers recommended.</p>';
                    return;
                }

                const serverTypes = {
                    't3.micro': { cost: 0.0104, capacity: 100 },
                    't3.small': { cost: 0.0208, capacity: 200 },
                    't3.medium': { cost: 0.0416, capacity: 400 },
                    't3.large': { cost: 0.0832, capacity: 800 },
                    't3.xlarge': { cost: 0.1664, capacity: 1600 }
                };

                const typeInfo = serverTypes[serverType] || serverTypes['t3.micro'];

                for (let i = 1; i <= recommendedServers; i++) {
                    const serverItem = document.createElement('div');
                    serverItem.className = 'server-item';
                    serverItem.style.animationDelay = `${i * 0.1}s`;

                    const region = document.getElementById('cloudRegion').value || 'us-east-1';
                    const serverName = `${serverType}-${region}-${String(i).padStart(3, '0')}`;
                    const utilization = Math.round(60 + Math.random() * 30);

                    serverItem.innerHTML = `
                        <div class="server-info">
                            <i class="fas fa-server server-icon"></i>
                            <div class="server-details">
                                <span class="server-name">${serverName}</span>
                                <span class="server-type">${serverType}  ${utilization}% utilized  ${typeInfo.capacity} req/min</span>
                            </div>
                        </div>
                        <div class="server-cost">\$${typeInfo.cost.toFixed(4)}/hr</div>
                    `;

                    serverListEl.appendChild(serverItem);
                }
            }

            updateDashboardMetrics(traffic = null, servers = null, cost = null) {
                const currentTrafficEl = document.getElementById('currentTraffic');
                const activeServersEl = document.getElementById('activeServers');
                const currentCostEl = document.getElementById('currentCost');

                const applyHighlight = (element) => {
                    element.classList.add('highlight');
                    setTimeout(() => element.classList.remove('highlight'), 1200);
                };

                if (traffic !== null) {
                    currentTrafficEl.textContent = Math.round(traffic);
                    applyHighlight(currentTrafficEl);
                }

                if (servers !== null) {
                    activeServersEl.textContent = servers;
                    applyHighlight(activeServersEl);
                }

                if (cost !== null) {
                    currentCostEl.textContent = `\$${cost.toFixed(3)}`;
                    applyHighlight(currentCostEl);
                }
            }

            startRealTimeUpdates() {
                // Check API status every 30 seconds
                setInterval(() => {
                    this.checkApiStatus();
                }, 30000);

                // Check general health every 15 seconds
                setInterval(() => {
                    this.checkApiHealth();
                    this.simulateRealTimeData();
                }, this.updateInterval);
            }

            simulateRealTimeData() {
                if (this.charts.traffic && this.charts.traffic.data.datasets[0].data.length > 0) {
                    const lastTraffic = this.charts.traffic.data.datasets[0].data.slice(-1)[0];
                    const variation = (Math.random() - 0.5) * 20;
                    const newTraffic = Math.max(50, lastTraffic + variation);

                    if (this.charts.performance) {
                        const utilization = newTraffic / 400;
                        this.charts.performance.data.datasets[0].data = [
                            Math.max(10, Math.min(90, 50 + utilization * 40)),
                            Math.max(20, Math.min(80, 40 + utilization * 30)),
                            Math.max(15, Math.min(85, 35 + utilization * 25)),
                            Math.max(30, Math.min(90, 60 + Math.random() * 20)),
                            Math.max(25, Math.min(75, 45 + Math.random() * 15)),
                            Math.max(40, Math.min(95, 70 + Math.random() * 10))
                        ];
                        this.charts.performance.update('none');
                    }
                }
            }

            showAlert(type, message) {
                const alertContainer = document.getElementById('alertContainer');
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${type}`;
                alertDiv.innerHTML = message;
                alertContainer.appendChild(alertDiv);

                setTimeout(() => {
                    alertDiv.style.opacity = '0';
                    alertDiv.style.transform = 'translateX(100%)';
                    setTimeout(() => alertDiv.remove(), 500);
                }, 5000);
            }
        }

        // Utility functions
        function togglePassword(fieldId) {
            const field = document.getElementById(fieldId);
            const toggle = field.nextElementSibling;

            if (field.type === 'password') {
                field.type = 'text';
                toggle.classList.remove('fa-eye');
                toggle.classList.add('fa-eye-slash');
            } else {
                field.type = 'password';
                toggle.classList.remove('fa-eye-slash');
                toggle.classList.add('fa-eye');
            }
        }

        function refreshDashboard() {
            window.location.reload();
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.dashboard = new EnhancedCloudDashboard();
        });
    </script>
</body>
</html>
